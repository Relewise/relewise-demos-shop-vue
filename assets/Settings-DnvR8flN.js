import{d as j,t as _,c as R,o as i,a as d,b as e,e as V,F as w,r as P,w as f,v as C,f as v,g as $,h as E,u as s,i as T,j as le,k as x,l as O,D as ae,U as se,m as ne,n as z,p as H}from"./index-7eUIqBpx.js";const oe={class:"text-sm block mt-6"},ie={class:"flex flex-col gap-4"},ue=["onUpdate:modelValue"],de=["onUpdate:modelValue"],re=["onClick"],K=j({__name:"KeyValues",props:{modelValue:{type:Object,required:!0},title:{type:String,required:!0}},emits:["update:modelValue"],setup(I,{emit:g}){const u=I,{modelValue:l}=_(u),h=g,b=R({get:()=>l.value,set:k=>{h("update:modelValue",k)}});function y(){b.value.push({key:"",value:""})}function c(k){b.value.splice(k,1)}return(k,U)=>(i(),d(w,null,[e("label",oe,V(I.title),1),e("div",ie,[(i(!0),d(w,null,P(b.value,(m,p)=>(i(),d("div",{key:p,class:"flex gap-4"},[f(e("input",{"onUpdate:modelValue":a=>m.key=a,type:"text",placeholder:"Key"},null,8,ue),[[C,m.key]]),f(e("input",{"onUpdate:modelValue":a=>m.value=a,type:"text",placeholder:"Value"},null,8,de),[[C,m.value]]),e("button",{class:"bg-gray-500 text-white",onClick:a=>c(p)}," Remove ",8,re)]))),128)),e("div",null,[e("button",{class:"outline",onClick:y}," Add new ")])])],64))}}),me={class:"bg-white rounded p-6"},pe={class:"flex mb-2 items-center"},ve={class:"flex gap-3 items-center"},ce={class:"flex-grow"},ye=["value"],ge=["value"],fe={key:1,class:"flex gap-3 items-center"},be={class:"flex gap-2"},ke={class:"flex gap-2"},xe={class:"flex gap-2"},we=["value","disabled"],Ce={value:""},he=["value"],Ue={key:3},Ie={class:"bg-red-100 text-red-900 px-3 py-1.5 rounded"},Se={class:"mt-6"},Ve={key:0,class:"ml-4 text-green-600"},$e={class:"flex gap-3 items-center"},De={class:"flex-grow"},Ne=["value"],Pe=["value"],Le={class:"flex gap-2"},Ae={class:"mt-6"},Te=["value","disabled"],Oe={value:"",disabled:"",selected:""},je=["value"],Ke={key:0,class:"ml-4 text-green-600"},Re=j({__name:"Personalisation",setup(I){var B;const g=v.tracking,u=v.context,l=v.user,h=$(!1),b=$(!1),y=$(Object.keys(l.value.classifications??{}).map(n=>({key:n,value:l.value.classifications[n]??null}))),c=$(Object.keys(l.value.identifiers??{}).map(n=>({key:n,value:l.value.identifiers[n]??null}))),k=$(Object.keys(l.value.data??{}).map(n=>({key:n,value:l.value.data&&l.value.data[n].type==="String"?l.value.data[n].value:null}))),U=$([]),m=$(((B=u.value.companies)==null?void 0:B.length)===1?u.value.companies[0]:{id:""});function p(n){const t=crypto.randomUUID();switch(n){case"temporary":{l.value.temporaryId=t;break}case"authenticated":{l.value.authenticatedId=t;break}case"companyId":{m.value||(m.value={id:""}),m.value.id=t;break}}}function a(){U.value=[],y.value.some(n=>!n.key||!n.value)&&U.value.push("You must provide a key and value for all classifications"),c.value.some(n=>!n.key||!n.value)&&U.value.push("You must provide a key and value for all identifiers"),k.value.some(n=>!n.key||!n.value)&&U.value.push("You must provide a key and value for all data elements"),!(U.value.length>0)&&(l.value.classifications=y.value.reduce((n,t)=>(n[t.key]=t.value,n),{}),l.value.identifiers=c.value.reduce((n,t)=>(n[t.key]=t.value,n),{}),l.value.data=k.value.reduce((n,t)=>(n[t.key]=ae.string(t.value??""),n),{}),v.persistState(),h.value=!0,setTimeout(()=>h.value=!1,3e3))}function r(n){v.setUser(n),y.value=Object.keys(l.value.classifications??{}).map(t=>({key:t,value:l.value.classifications[t]??null})),c.value=Object.keys(l.value.identifiers??{}).map(t=>({key:t,value:l.value.identifiers[t]??null})),k.value=Object.keys(l.value.data??{}).map(t=>({key:t,value:l.value.data&&l.value.data[t].type==="String"?l.value.data[t].value:null}))}function D(){const n=se.anonymous();u.value.users||(u.value.users=[]),u.value.users.push(n),r(n)}function A(){confirm("Delete user?")&&v.deleteSelectedUser()}function Q(n){var S;const t=(S=u.value.companies)==null?void 0:S.find(N=>N.id===n);l.value.company=t}function X(n){var S;const t=(S=u.value.companies)==null?void 0:S.find(N=>N.id===n);t&&(m.value=t)}function Z(n){var S;const t=(S=u.value.companies)==null?void 0:S.find(N=>N.id===n);t&&(m.value.parent=t)}function ee(){if(u.value.companies||(u.value.companies=[]),!m.value||!m.value.id){alert("A company id is required.");return}u.value.companies=u.value.companies.filter(n=>n.id!==m.value.id),u.value.companies.push(m.value),v.persistState(),b.value=!0,setTimeout(()=>b.value=!1,3e3)}function q(){m.value={id:""}}function te(){confirm("Delete company?")&&m.value&&(v.deleteCompanyById(m.value.id),q())}return(n,t)=>{var S,N,F,J,M,G,Y;return i(),d("div",me,[t[20]||(t[20]=e("div",{class:"flex items-center mb-8"},[e("h1",{class:"text-4xl"}," Behavioral tracking ")],-1)),e("label",pe,[f(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>s(g).enabled=o),class:"accent-brand-500 mr-3 h-5 w-5",type:"checkbox"},null,512),[[E,s(g).enabled]]),t[15]||(t[15]=T(" Tracking enabled"))]),t[21]||(t[21]=e("p",{class:"text-gray-400"}," When tracking is enabled, all your actions are tracked to Relewise to give you a personal experience ",-1)),t[22]||(t[22]=e("hr",{class:"my-8"},null,-1)),t[23]||(t[23]=e("div",{class:"flex items-center mb-8"},[e("h1",{class:"text-4xl"}," User ")],-1)),s(u).users&&((S=s(u).users)==null?void 0:S.length)>1?(i(),d(w,{key:0},[e("div",ve,[e("button",{class:"bg-gray-500 text-white",onClick:D}," Add new user "),e("div",ce,[t[16]||(t[16]=e("label",{class:"text-sm block"},"Select user",-1)),e("select",{value:JSON.stringify(s(l)),class:"mb-6",onChange:t[1]||(t[1]=o=>r(JSON.parse(o.target.value)))},[(i(!0),d(w,null,P(s(u).users,(o,L)=>(i(),d("option",{key:L,value:JSON.stringify(o)},V(s(le)(o)),9,ge))),128))],40,ye)]),e("div",null,[e("button",{class:"bg-gray-500 text-white",onClick:A}," Delete selected user ")])]),t[17]||(t[17]=e("hr",{class:"mb-6"},null,-1))],64)):(i(),d("div",fe,[e("button",{class:"bg-gray-500 text-white",onClick:D}," Add new user ")])),t[24]||(t[24]=e("label",{class:"text-sm block"},"Temporary Id",-1)),e("div",be,[s(l)?f((i(),d("input",{key:0,"onUpdate:modelValue":t[2]||(t[2]=o=>s(l).temporaryId=o),type:"text",placeholder:"Temporary Id"},null,512)),[[C,s(l).temporaryId]]):x("",!0),e("button",{class:"bg-gray-500 text-white",onClick:t[3]||(t[3]=o=>p("temporary"))}," Generate ")]),t[25]||(t[25]=e("label",{class:"text-sm block mt-6"},"Authenticated Id",-1)),e("div",ke,[s(l)?f((i(),d("input",{key:0,"onUpdate:modelValue":t[4]||(t[4]=o=>s(l).authenticatedId=o),type:"text",placeholder:"Authenticated Id"},null,512)),[[C,s(l).authenticatedId]]):x("",!0),e("button",{class:"bg-gray-500 text-white",onClick:t[5]||(t[5]=o=>p("authenticated"))}," Generate ")]),t[26]||(t[26]=e("label",{class:"text-sm block mt-6"},"Email",-1)),e("div",xe,[s(l)?f((i(),d("input",{key:0,"onUpdate:modelValue":t[6]||(t[6]=o=>s(l).email=o),type:"text",placeholder:"Email"},null,512)),[[C,s(l).email]]):x("",!0)]),s(l)?(i(),d(w,{key:2},[O(K,{modelValue:y.value,"onUpdate:modelValue":t[7]||(t[7]=o=>y.value=o),title:"Classifications"},null,8,["modelValue"]),O(K,{modelValue:c.value,"onUpdate:modelValue":t[8]||(t[8]=o=>c.value=o),title:"Identifiers"},null,8,["modelValue"]),O(K,{modelValue:k.value,"onUpdate:modelValue":t[9]||(t[9]=o=>k.value=o),title:"Data"},null,8,["modelValue"])],64)):x("",!0),t[27]||(t[27]=e("label",{class:"text-sm block mt-6"},"Select company",-1)),e("select",{value:(N=s(l).company)==null?void 0:N.id,class:"mb-6",disabled:!s(u).companies||s(u).companies.length<1,onChange:t[10]||(t[10]=o=>Q(o.target.value))},[e("option",Ce,V(s(u).companies&&s(u).companies.length>0?"No company assigned":"No companies exist"),1),(i(!0),d(w,null,P(s(u).companies,(o,L)=>(i(),d("option",{key:L,value:o.id},V(o.id),9,he))),128))],40,we),U.value.length>0?(i(),d("div",Ue,[e("ul",Ie,[(i(!0),d(w,null,P(U.value,o=>(i(),d("li",{key:o},V(o),1))),128))])])):x("",!0),e("div",Se,[e("button",{onClick:a}," Save user "),h.value?(i(),d("span",Ve," User has been saved. ")):x("",!0)]),t[28]||(t[28]=e("hr",{class:"my-8"},null,-1)),t[29]||(t[29]=e("div",{class:"flex items-center mb-8"},[e("h1",{class:"text-4xl"}," Company ")],-1)),e("div",$e,[s(u).companies&&s(u).companies.length>0?(i(),d("button",{key:0,class:"bg-gray-500 text-white",onClick:q}," Add new company ")):x("",!0),s(u).companies&&((F=s(u).companies)==null?void 0:F.length)>0?(i(),d(w,{key:1},[e("div",De,[t[18]||(t[18]=e("label",{class:"text-sm block"},"Select company",-1)),e("select",{value:(J=m.value)==null?void 0:J.id,class:"mb-6",onChange:t[11]||(t[11]=o=>X(o.target.value))},[(i(!0),d(w,null,P(s(u).companies,(o,L)=>(i(),d("option",{key:L,value:o.id},V(o.id),9,Pe))),128))],40,Ne)]),e("div",null,[e("button",{class:"bg-gray-500 text-white",onClick:te}," Delete selected company ")])],64)):x("",!0)]),t[30]||(t[30]=e("label",{class:"text-sm block"},"Id",-1)),e("div",Le,[m.value?f((i(),d("input",{key:0,"onUpdate:modelValue":t[12]||(t[12]=o=>m.value.id=o),type:"text",placeholder:"Id"},null,512)),[[C,m.value.id]]):x("",!0),e("button",{class:"bg-gray-500 text-white",onClick:t[13]||(t[13]=o=>p("companyId"))}," Generate ")]),e("div",Ae,[t[19]||(t[19]=e("label",{class:"text-sm block"},"Select parent company",-1)),e("select",{value:(G=(M=m.value)==null?void 0:M.parent)==null?void 0:G.id,disabled:!s(u).companies||s(u).companies.length<2,class:"mb-6",onChange:t[14]||(t[14]=o=>Z(o.target.value))},[e("option",Oe,V(s(u).companies&&s(u).companies.length>1?"Select a company":"No other companies"),1),(i(!0),d(w,null,P((Y=s(u).companies)==null?void 0:Y.filter(o=>o.id!==m.value.id),(o,L)=>(i(),d("option",{key:L,value:o.id},V(o.id),9,je))),128))],40,Te)]),e("div",null,[e("button",{onClick:ee}," Save company "),b.value?(i(),d("span",Ke," Company has been saved. ")):x("",!0)])])}}}),Ee={class:"text-sm block mt-6"},qe={key:0,class:"flex mt-2 gap-2"},Be=["placeholder"],Fe=["onUpdate:modelValue","placeholder"],Je=["onClick"],Me={class:"flex mt-2 gap-2"},Ge=["placeholder"],W=j({__name:"ListValues",props:{label:{type:String,required:!0},items:{type:Array,default:null},singleItem:{type:String,default:null},inputPlaceholder:{type:String,required:!0},newItemPlaceholder:{type:String,required:!0}},emits:["update:singleItem","update:items"],setup(I,{emit:g}){const u=I,{singleItem:l,items:h}=_(u),b=$(""),y=R({get:()=>l.value,set:p=>{k("update:singleItem",p)}}),c=R({get:()=>h.value??[],set:p=>{k("update:items",p)}}),k=g;function U(){b.value&&(c.value||(c.value=y.value?[y.value]:[]),y.value||(y.value=b.value),c.value.push(b.value),b.value="",v.persistState())}function m(p){if(!c.value){c.value=[],y.value="",v.persistState();return}c.value.splice(p,1),v.persistState()}return(p,a)=>(i(),d("div",null,[e("label",Ee,V(I.label),1),!c.value&&y.value?(i(),d("div",qe,[f(e("input",{"onUpdate:modelValue":a[0]||(a[0]=r=>y.value=r),type:"text",placeholder:I.inputPlaceholder},null,8,Be),[[C,y.value]]),e("button",{class:"bg-gray-500 text-white",onClick:a[1]||(a[1]=r=>m(0))}," Remove ")])):(i(!0),d(w,{key:1},P(c.value,(r,D)=>(i(),d("div",{key:D,class:"flex mt-2 gap-2"},[f(e("input",{"onUpdate:modelValue":A=>c.value[D]=A,type:"text",placeholder:I.inputPlaceholder},null,8,Fe),[[C,c.value[D]]]),e("button",{class:"bg-gray-500 text-white",onClick:A=>m(D)}," Remove ",8,Je)]))),128)),e("div",Me,[f(e("input",{"onUpdate:modelValue":a[2]||(a[2]=r=>b.value=r),type:"text",placeholder:I.newItemPlaceholder},null,8,Ge),[[C,b.value]]),e("button",{class:"outline",onClick:U}," Add ")])]))}}),Ye={class:"bg-white rounded p-6"},ze={class:"flex gap-3 items-center"},He={class:"flex-grow"},We=["value"],_e=["value"],Qe={class:"pl-8 flex flex-col gap-4"},Xe={class:"flex mt-2 items-center"},Ze={class:"flex mt-2 items-center"},et={class:"flex mt-4 gap-3"},tt={key:0,class:"ml-4 text-green-600"},lt={key:0,class:"ml-4 text-green-600"},at=j({__name:"DatasetSettings",setup(I){const g=$(!1),u=$(!1),l=v.context,h=v.datasets;async function b(){const p=new URLSearchParams(window.location.search);if(p.has("share")){const a=atob(p.get("share")),r=JSON.parse(a);h.value.every(A=>A.datasetId!==r.datasetId)?(v.addDataset(r),v.persistState()):v.setDataset(r.datasetId);const D=new URL(window.location.href);D.searchParams.delete("share"),history.replaceState(null,"",D),await ne.push("/"),window.location.reload()}}b();function y(p){v.setDataset(p),window.location.reload()}function c(){v.persistState(),g.value=!0,setTimeout(()=>g.value=!1,3e3)}function k(){v.addDataset({displayName:"",apiKey:"",datasetId:"",currencyCode:"",allCurrencies:[],language:"",allLanguages:[],users:[],companies:[],selectedUserIndex:0}),v.setDataset("")}function U(){const p={displayName:l.value.displayName,apiKey:l.value.apiKey,datasetId:l.value.datasetId,currencyCode:l.value.currencyCode,language:l.value.language,allLanguages:l.value.allLanguages,allCurrencies:l.value.allCurrencies,serverUrl:l.value.serverUrl,users:l.value.users,companies:l.value.companies,selectedUserIndex:l.value.selectedUserIndex};navigator.clipboard.writeText(window.location.href+"?share="+encodeURIComponent(btoa(JSON.stringify(p)))),u.value=!0,setTimeout(()=>u.value=!1,3e3)}function m(){confirm("delete dataset?")&&v.deleteSelected()}return(p,a)=>(i(),d("div",Ye,[a[18]||(a[18]=e("div",{class:"flex items-center mb-8"},[e("h1",{class:"text-4xl"}," Settings ")],-1)),s(h).length>1?(i(),d(w,{key:0},[e("div",ze,[e("button",{class:"bg-gray-500 text-white",onClick:k}," Add new dataset "),e("div",He,[a[8]||(a[8]=e("label",{class:"text-sm block"},"Select dataset",-1)),e("select",{value:s(l).datasetId,class:"mb-6",onChange:a[0]||(a[0]=r=>y(r.target.value))},[(i(!0),d(w,null,P(s(h),r=>(i(),d("option",{key:r.datasetId,value:r.datasetId},V(r.displayName)+" ("+V(r.datasetId)+") ",9,_e))),128))],40,We)]),e("div",null,[s(h).length>1?(i(),d("button",{key:0,class:"bg-gray-500 text-white",onClick:m}," Delete selected dataset ")):x("",!0)])]),a[9]||(a[9]=e("hr",{class:"mb-6"},null,-1))],64)):(i(),d("button",{key:1,class:"bg-gray-500 text-white",onClick:k}," Add new dataset ")),a[19]||(a[19]=e("label",{class:"text-sm block"},"Name",-1)),f(e("input",{"onUpdate:modelValue":a[1]||(a[1]=r=>s(l).displayName=r),type:"text",placeholder:"Name"},null,512),[[C,s(l).displayName]]),a[20]||(a[20]=e("label",{class:"text-sm block mt-6"},"Dataset Id",-1)),f(e("input",{"onUpdate:modelValue":a[2]||(a[2]=r=>s(l).datasetId=r),type:"text",placeholder:"Dataset id"},null,512),[[C,s(l).datasetId]]),a[21]||(a[21]=e("label",{class:"text-sm block mt-6"},"API Key",-1)),f(e("input",{"onUpdate:modelValue":a[3]||(a[3]=r=>s(l).apiKey=r),type:"text",placeholder:"Api key"},null,512),[[C,s(l).apiKey]]),O(W,{label:"Languages",items:s(l).allLanguages,"single-item":s(l).language,"input-placeholder":"LanguageCode","new-item-placeholder":"New Language"},null,8,["items","single-item"]),O(W,{label:"Currencies",items:s(l).allCurrencies,"single-item":s(l).currencyCode,"input-placeholder":"CurrencyCode","new-item-placeholder":"New Currency"},null,8,["items","single-item"]),a[22]||(a[22]=e("label",{class:"text-sm block mt-6"},"Server url",-1)),f(e("input",{"onUpdate:modelValue":a[4]||(a[4]=r=>s(l).serverUrl=r),type:"text",placeholder:"Server Url"},null,512),[[C,s(l).serverUrl]]),a[23]||(a[23]=e("hr",{class:"my-8"},null,-1)),a[24]||(a[24]=e("h2",{class:"text-2xl mb-6"}," Features ",-1)),e("div",Qe,[e("div",null,[e("label",Xe,[f(e("input",{"onUpdate:modelValue":a[5]||(a[5]=r=>s(l).allowThirdLevelCategories=r),class:"accent-brand-500 mr-3 h-5 w-5",type:"checkbox"},null,512),[[E,s(l).allowThirdLevelCategories]]),a[10]||(a[10]=T(" Third level categories"))]),a[11]||(a[11]=e("p",{class:"text-gray-500 text-sm mt-1"},[T(" When third level categories are enabled, category links will also be rendered on the PLP's of categories with parents."),e("br"),T(" This will allow users to navigate to a PLP of third level category. ")],-1))]),e("div",null,[e("label",Ze,[f(e("input",{"onUpdate:modelValue":a[6]||(a[6]=r=>s(l).hideSoldOutProducts=r),class:"accent-brand-500 mr-3 h-5 w-5",type:"checkbox"},null,512),[[E,s(l).hideSoldOutProducts]]),a[12]||(a[12]=T(" Hide ")),a[13]||(a[13]=e("span",{class:"font-medium px-1"},"Sold out",-1)),a[14]||(a[14]=T(" in recommendations"))]),a[15]||(a[15]=e("p",{class:"text-gray-500 text-sm mt-1"}," Hide Products with a 'SoldOut' datakey in recommendations. ",-1))]),e("div",null,[a[16]||(a[16]=e("label",{class:"text-sm block mt-6"},"Set 'Minutes ago' used for recommendations",-1)),f(e("input",{"onUpdate:modelValue":a[7]||(a[7]=r=>s(l).recommendationsMinutesAgo=r),type:"text"},null,512),[[C,s(l).recommendationsMinutesAgo]]),a[17]||(a[17]=e("p",{class:"text-gray-500 text-sm mt-1"}," Default is 14 days. ",-1))])]),a[25]||(a[25]=e("hr",{class:"my-8"},null,-1)),e("div",et,[e("button",{class:"bg-gray-500 text-white",onClick:U}," Get share link "),u.value?(i(),d("span",tt," Copied! ")):x("",!0)]),a[26]||(a[26]=e("hr",{class:"my-10"},null,-1)),e("div",null,[e("button",{class:"",onClick:c}," Save "),g.value?(i(),d("span",lt," Settings have been saved. ")):x("",!0)])]))}}),st={class:"flex gap-2 pt-3"},nt={class:"bg-white rounded-tr rounded-b"},it=j({__name:"Settings",setup(I){const g=$(0);return(u,l)=>(i(),d(w,null,[e("div",st,[e("div",{class:z((g.value==0?"bg-white":"bg-gray-50")+" text-black rounded-t cursor-pointer w-36 h-10 flex items-center justify-center text-center"),onClick:l[0]||(l[0]=()=>g.value=0)},l[2]||(l[2]=[e("span",null," Settings ",-1)]),2),e("div",{class:z((g.value==1?"bg-white":"bg-gray-50")+" text-black rounded-t cursor-pointer w-36 h-10 flex items-center justify-center text-center"),onClick:l[1]||(l[1]=()=>g.value=1)},l[3]||(l[3]=[e("span",null," Personalization ",-1)]),2)]),e("div",nt,[g.value===0?(i(),H(at,{key:0})):x("",!0),g.value===1?(i(),H(Re,{key:1})):x("",!0)])],64))}});export{it as default};
